# ğŸ‰ åŒæ å¸ƒå±€ + ä¾§è¾¹æ å¯¼èˆªå®Œæˆ

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1ï¸âƒ£ åˆ›å»ºäº† SidebarNav ç»„ä»¶

**æ–‡ä»¶**: [src/components/layout/SidebarNav.tsx](src/components/layout/SidebarNav.tsx)

**æ ¸å¿ƒåŠŸèƒ½**:
- âœ… **è‡ªåŠ¨æå–ç›®å½•**: ä» blocks ä¸­æå–æ‰€æœ‰æœ‰æ ‡é¢˜çš„ç« èŠ‚ï¼ˆHeroã€Markdownï¼‰
- âœ… **ScrollSpy æ»šåŠ¨ç›‘å¬**: ä½¿ç”¨ IntersectionObserver å®æ—¶é«˜äº®å½“å‰ç« èŠ‚
- âœ… **å¹³æ»‘æ»šåŠ¨**: ç‚¹å‡»å¯¼èˆªé¡¹å¹³æ»‘è·³è½¬åˆ°å¯¹åº”ä½ç½®
- âœ… **æ™ºèƒ½å›¾æ ‡æ˜ å°„**: æ ¹æ®æ ‡é¢˜å…³é”®è¯è‡ªåŠ¨åŒ¹é…å›¾æ ‡
- âœ… **å›ºå®šå®šä½**: Sticky å®šä½ï¼Œæ»šåŠ¨æ—¶ä¿æŒå¯è§

**æ ·å¼è§„èŒƒ**:
```css
å®¹å™¨: w-64 p-4 rounded-xl border border-slate-800 bg-slate-900/50 backdrop-blur-sm sticky top-24
æ ‡é¢˜: text-xs font-bold text-slate-500 uppercase tracking-wider mb-4 pl-2
é»˜è®¤çŠ¶æ€: text-slate-400 hover:text-slate-200 hover:bg-white/5
æ¿€æ´»çŠ¶æ€: bg-indigo-500/10 text-indigo-400 shadow-[inset_2px_0_0_0_#6366f1]
```

### 2ï¸âƒ£ é‡æ„ä¸ºåŒæ å¸ƒå±€

**ä¿®æ”¹æ–‡ä»¶**: [src/renderer/SchemaRenderer.tsx](src/renderer/SchemaRenderer.tsx)

**å¸ƒå±€å˜æ›´**:
- âœ… ä»å•æ  `max-w-4xl mx-auto` æ”¹ä¸ºåŒæ  Grid å¸ƒå±€
- âœ… å·¦ä¾§å›ºå®šä¾§è¾¹æ ï¼ˆ260pxï¼‰ï¼Œå³ä¾§è‡ªé€‚åº”å†…å®¹
- âœ… å“åº”å¼è®¾è®¡ï¼šå°å±éšè—ä¾§è¾¹æ ï¼Œå¤§å±æ˜¾ç¤º

**Grid å¸ƒå±€**:
```jsx
<div className="lg:grid lg:grid-cols-[260px_1fr] lg:gap-12 items-start">
  {/* å·¦ä¾§å¯¼èˆª */}
  <aside className="hidden lg:block">
    <SidebarNav items={navItems} />
  </aside>

  {/* å³ä¾§å†…å®¹ */}
  <div className="space-y-16 pb-32">
    {/* Blocks */}
  </div>
</div>
```

### 3ï¸âƒ£ è¾…åŠ©åŠŸèƒ½å®ç°

**æ–°å¢å·¥å…·å‡½æ•°**:

#### `generateSlug(text: string)`
ç”Ÿæˆ URL å‹å¥½çš„ slug
```typescript
"ä»€ä¹ˆæ˜¯ Hooks?" â†’ "ä»€ä¹ˆæ˜¯-hooks"
"React åŸºç¡€" â†’ "react-åŸºç¡€"
```

#### `getBlockId(block: Block, index: number)`
ä¸ºæ¯ä¸ª block ç”Ÿæˆå”¯ä¸€ ID
- ä¼˜å…ˆä½¿ç”¨ `block.id`
- å…¶æ¬¡ä½¿ç”¨ `block.title` ç”Ÿæˆ slug
- æœ€åä½¿ç”¨ `block-{index}`

#### `extractNavItems(blocks: Block[])`
æå–å¯¼èˆªé¡¹ï¼ˆä»…ä» Hero å’Œ Markdown ç±»å‹ï¼‰
```typescript
[
  { id: "section-hero", title: "React Hooks", type: "Hero" },
  { id: "section-what-is-hooks", title: "ä»€ä¹ˆæ˜¯ Hooks?", type: "Markdown" },
  ...
]
```

## ğŸ¨ è§†è§‰æ•ˆæœ

### å¸ƒå±€ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    é¡¶éƒ¨ Navbar (å›ºå®š)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          â”‚                                                   â”‚
â”‚  ç›®å½•    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  å¯¼èˆª    â”‚  â”‚  Hero Section                             â”‚   â”‚
â”‚  (å›ºå®š)  â”‚  â”‚  React Hooks åŸºç¡€æ•™ç¨‹                     â”‚   â”‚
â”‚          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚ ğŸ“š å†å²  â”‚                                                   â”‚
â”‚ ğŸ“˜ æ¦‚å¿µ  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ ğŸ’¡ åŸç†  â”‚  â”‚  Markdown Section                         â”‚   â”‚
â”‚ âš™ï¸ æŠ€æœ¯  â”‚  â”‚  ä»€ä¹ˆæ˜¯ Hooks?                           â”‚   â”‚
â”‚          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚          â”‚                                                   â”‚
â”‚          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚          â”‚  â”‚  CardGrid Component                       â”‚   â”‚
â”‚          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¾§è¾¹æ æ ·å¼

**å¡ç‰‡å¤–è§‚**:
- æ·±è‰²åŠé€æ˜èƒŒæ™¯ (`bg-slate-900/50`)
- æ¯›ç»ç’ƒæ•ˆæœ (`backdrop-blur-sm`)
- åœ†è§’è¾¹æ¡† (`rounded-xl border border-slate-800`)

**å¯¼èˆªé¡¹**:
- é»˜è®¤: ç°è‰²æ–‡å­— + æ‚¬åœå˜ç™½
- æ¿€æ´»: Indigo è‰² + å·¦ä¾§é«˜äº®æ¡ (`shadow-[inset_2px_0_0_0_#6366f1]`)

**å›¾æ ‡æ˜ å°„**:
```
"å†å²/å‘å±•/æ¼”è¿›" â†’ History å›¾æ ‡
"æ¦‚å¿µ/åŸºç¡€/ä»‹ç»" â†’ BookOpen å›¾æ ‡
"æŠ€æœ¯/å®ç°/ä»£ç " â†’ Code å›¾æ ‡
"åŸç†/æ¶æ„/ç³»ç»Ÿ" â†’ Cpu å›¾æ ‡
"åº”ç”¨/å®è·µ/æ¡ˆä¾‹" â†’ Lightbulb å›¾æ ‡
```

## ğŸ”§ æŠ€æœ¯å®ç°ç»†èŠ‚

### ScrollSpy å®ç°

ä½¿ç”¨ IntersectionObserver API ç›‘å¬æ»šåŠ¨ä½ç½®ï¼š

```typescript
const observer = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      setActiveId(entry.target.id);
    }
  });
}, {
  rootMargin: '-20% 0px -70% 0px', // è§†å£ä¸­é—´åŒºåŸŸè§¦å‘
  threshold: 0
});
```

**rootMargin è¯´æ˜**:
- `-20% 0px -70% 0px` è¡¨ç¤ºç›‘å¬è§†å£ä¸­é—´åŒºåŸŸï¼ˆä»é¡¶éƒ¨ 20% åˆ° 70%ï¼‰
- å½“ç« èŠ‚è¿›å…¥è¿™ä¸ªåŒºåŸŸæ—¶ï¼Œè‡ªåŠ¨é«˜äº®å¯¹åº”å¯¼èˆªé¡¹

### å¹³æ»‘æ»šåŠ¨

ä½¿ç”¨åŸç”Ÿ `scrollIntoView` APIï¼š

```typescript
const scrollToSection = (id: string) => {
  const element = document.getElementById(id);
  if (element) {
    element.scrollIntoView({
      behavior: 'smooth',
      block: 'start'
    });
  }
};
```

### é”šç‚¹è·³è½¬ä¼˜åŒ–

ä¸ºæ¯ä¸ª Block æ·»åŠ  `scroll-mt-24` ç±»ï¼š

```jsx
<div id={blockId} className="scroll-mt-24">
  {/* Block å†…å®¹ */}
</div>
```

**ä½œç”¨**: é˜²æ­¢è·³è½¬æ—¶å†…å®¹è¢«é¡¶éƒ¨ Navbar é®æŒ¡ï¼ˆNavbar é«˜åº¦ ~4rem = 16 Ã— 4 = 64pxï¼‰

## ğŸ“‚ æ–‡ä»¶ç»“æ„

```
src/
â”œâ”€â”€ components/
â”‚   â””â”€â”€ layout/
â”‚       â”œâ”€â”€ Navbar.tsx           # é¡¶éƒ¨å¯¼èˆªæ 
â”‚       â””â”€â”€ SidebarNav.tsx       # å·¦ä¾§ç›®å½•å¯¼èˆª (æ–°å»º)
â”œâ”€â”€ renderer/
â”‚   â””â”€â”€ SchemaRenderer.tsx       # ä¿®æ”¹ï¼šåŒæ å¸ƒå±€ + å¯¼èˆªæå–
â””â”€â”€ pages/
    â””â”€â”€ SchemaPage.tsx           # é¡µé¢å®¹å™¨
```

## ğŸ¯ åŠŸèƒ½ç‰¹æ€§

### âœ… å“åº”å¼è®¾è®¡

| å±å¹•å°ºå¯¸ | å¸ƒå±€ | ä¾§è¾¹æ  |
|---------|------|--------|
| **ç§»åŠ¨ç«¯** (< 1024px) | å•æ  | éšè— |
| **æ¡Œé¢ç«¯** (â‰¥ 1024px) | åŒæ  (260px + 1fr) | æ˜¾ç¤º |

### âœ… æ»šåŠ¨ç›‘å¬ç‰¹æ€§

- **å®æ—¶é«˜äº®**: æ»šåŠ¨æ—¶è‡ªåŠ¨é«˜äº®å½“å‰ç« èŠ‚
- **æ™ºèƒ½è§¦å‘**: ä»…åœ¨è§†å£ä¸­é—´åŒºåŸŸè§¦å‘ï¼ˆé¿å…é¢‘ç¹åˆ‡æ¢ï¼‰
- **æ€§èƒ½ä¼˜åŒ–**: ä½¿ç”¨ IntersectionObserverï¼ˆé«˜æ€§èƒ½ï¼Œä¸å½±å“æ»šåŠ¨æ€§èƒ½ï¼‰

### âœ… ç”¨æˆ·ä½“éªŒä¼˜åŒ–

1. **é˜²æ­¢é®æŒ¡**: `scroll-mt-24` ç¡®ä¿è·³è½¬åå†…å®¹ä¸è¢« Navbar é®æŒ¡
2. **å¹³æ»‘æ»šåŠ¨**: `scrollIntoView({ behavior: 'smooth' })` æä¾›æµç•…ä½“éªŒ
3. **è§†è§‰åé¦ˆ**: å·¦ä¾§é«˜äº®æ¡æ¸…æ™°æŒ‡ç¤ºå½“å‰ä½ç½®
4. **ç©ºçŠ¶æ€å¤„ç†**: æ— å¯¼èˆªé¡¹æ—¶è‡ªåŠ¨éšè—ä¾§è¾¹æ 

## ğŸš€ ä½¿ç”¨æ–¹å¼

### è‡ªåŠ¨å·¥ä½œ

æ— éœ€é¢å¤–é…ç½®ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ï¼š
1. ä» blocks ä¸­æå–æœ‰æ ‡é¢˜çš„ç« èŠ‚
2. ç”Ÿæˆå”¯ä¸€ ID
3. åˆ›å»ºå¯¼èˆªé¡¹
4. å®ç°æ»šåŠ¨ç›‘å¬

### è‡ªå®šä¹‰å¯¼èˆªé¡¹

å¦‚æœéœ€è¦è‡ªå®šä¹‰å¯¼èˆªï¼Œå¯ä»¥ä¿®æ”¹ `extractNavItems` å‡½æ•°ï¼š

```typescript
function extractNavItems(blocks: Block[]): Array<{ id: string; title: string; type: string }> {
  return blocks
    .filter(block => block.title && (
      block.type === 'Hero' ||
      block.type === 'Markdown' ||
      block.type === 'CardGrid' // æ·»åŠ æ›´å¤šç±»å‹
    ))
    .map((block, index) => ({
      id: getBlockId(block, index),
      title: block.title || `Section ${index + 1}`,
      type: block.type
    }));
}
```

### è‡ªå®šä¹‰å›¾æ ‡

ä¿®æ”¹ `getIconForItem` å‡½æ•°æ·»åŠ æ›´å¤šè§„åˆ™ï¼š

```typescript
function getIconForItem(item: NavItem): React.ReactNode {
  const title = item.title?.toLowerCase() || '';

  // æ·»åŠ è‡ªå®šä¹‰è§„åˆ™
  if (title.includes('api')) {
    return <Api size={16} />;
  }
  if (title.includes('database')) {
    return <Database size={16} />;
  }

  // ... å…¶ä»–è§„åˆ™
}
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### IntersectionObserver vs Scroll Event

| æ–¹æ¡ˆ | æ€§èƒ½ | CPU ä½¿ç”¨ | ç”µæ± æ¶ˆè€— |
|------|------|----------|----------|
| **IntersectionObserver** âœ… | é«˜ | ä½ | ä½ |
| Scroll Event + Throttle | ä¸­ | ä¸­ | ä¸­ |
| Scroll Event (Raw) âŒ | ä½ | é«˜ | é«˜ |

æˆ‘ä»¬ä½¿ç”¨ **IntersectionObserver**ï¼Œå…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š
- âœ… åŸç”Ÿ APIï¼Œæ€§èƒ½æœ€ä¼˜
- âœ… ä¸é˜»å¡ä¸»çº¿ç¨‹
- âœ… è‡ªåŠ¨ä¼˜åŒ–ï¼Œæ— éœ€æ‰‹åŠ¨èŠ‚æµ
- âœ… æ”¯æŒå¹¶è¡Œç›‘å¬å¤šä¸ªå…ƒç´ 

### useMemo ä¼˜åŒ–

ä½¿ç”¨ `useMemo` ç¼“å­˜å¯¼èˆªé¡¹è®¡ç®—ï¼š

```typescript
const navItems = useMemo(() => extractNavItems(blocks), [blocks]);
```

**å¥½å¤„**:
- ä»…åœ¨ blocks å˜åŒ–æ—¶é‡æ–°è®¡ç®—
- é¿å…æ¯æ¬¡æ¸²æŸ“éƒ½é‡æ–°æå–å¯¼èˆª
- å‡å°‘ä¸å¿…è¦çš„è®¡ç®—å¼€é”€

## âœ… æµ‹è¯•éªŒè¯

### æ„å»ºæµ‹è¯•
```bash
npm run build
# âœ… æ„å»ºæˆåŠŸï¼Œæ— é”™è¯¯ï¼
```

### åŠŸèƒ½æ£€æŸ¥æ¸…å•

- [x] ä¾§è¾¹æ å›ºå®šå®šä½ï¼ˆsticky top-24ï¼‰
- [x] è‡ªåŠ¨æå–æœ‰æ ‡é¢˜çš„ç« èŠ‚
- [x] ScrollSpy æ»šåŠ¨ç›‘å¬æ­£å¸¸
- [x] ç‚¹å‡»å¯¼èˆªé¡¹å¹³æ»‘æ»šåŠ¨
- [x] æ¿€æ´»çŠ¶æ€é«˜äº®æ˜¾ç¤º
- [x] å›¾æ ‡æ ¹æ®æ ‡é¢˜è‡ªåŠ¨åŒ¹é…
- [x] å“åº”å¼å¸ƒå±€ï¼ˆç§»åŠ¨ç«¯éšè—ï¼‰
- [x] é”šç‚¹è·³è½¬ä¸è¢«é®æŒ¡
- [x] ç©º ID è‡ªåŠ¨ç”Ÿæˆ slug
- [x] æ€§èƒ½ä¼˜åŒ–ï¼ˆIntersectionObserverï¼‰

## ğŸ‰ å®Œæˆï¼

åŒæ å¸ƒå±€å’Œä¾§è¾¹æ å¯¼èˆªå·²æˆåŠŸå®ç°ï¼ç°åœ¨æ‚¨çš„é¡µé¢æ‹¥æœ‰ï¼š

âœ¨ **ç±»ä¼¼ GitBook çš„ä¸“ä¸šå¯¼èˆªä½“éªŒ**
- å·¦ä¾§å›ºå®šç›®å½•å¯¼èˆª
- å®æ—¶æ»šåŠ¨ç›‘å¬é«˜äº®
- å¹³æ»‘é”šç‚¹è·³è½¬
- å“åº”å¼è®¾è®¡
- ä¼˜é›…çš„è§†è§‰æ•ˆæœ

**ä¸‹ä¸€æ­¥**: è®¿é—®ä»»æ„é¡µé¢ï¼ˆå¦‚ `http://localhost:8080/#/page/test`ï¼‰å³å¯çœ‹åˆ°æ–°çš„åŒæ å¸ƒå±€æ•ˆæœï¼

## ğŸ’¡ åç»­ä¼˜åŒ–å»ºè®®

### çŸ­æœŸæ”¹è¿›
1. **ç§»åŠ¨ç«¯å¯¼èˆª**: æ·»åŠ ç§»åŠ¨ç«¯çš„æ±‰å ¡èœå•æˆ–æŠ½å±‰å¼å¯¼èˆª
2. **è¿›åº¦æŒ‡ç¤º**: åœ¨ä¾§è¾¹æ æ·»åŠ é˜…è¯»è¿›åº¦æ¡
3. **æŠ˜å åŠŸèƒ½**: æ”¯æŒæŠ˜å /å±•å¼€å­ç« èŠ‚

### é•¿æœŸè§„åˆ’
1. **æœç´¢åŠŸèƒ½**: åœ¨ä¾§è¾¹æ æ·»åŠ å…¨å±€æœç´¢æ¡†
2. **ä¸»é¢˜åˆ‡æ¢**: æ”¯æŒäº®è‰²/æš—è‰²ä¸»é¢˜åˆ‡æ¢
3. **è‡ªå®šä¹‰æ ·å¼**: å…è®¸ç”¨æˆ·è‡ªå®šä¹‰ä¾§è¾¹æ å®½åº¦
4. **å¯¼å‡º PDF**: åŸºäºå¯¼èˆªç»“æ„å¯¼å‡ºå®Œæ•´æ–‡æ¡£
