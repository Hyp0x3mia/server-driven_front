# çŸ¥è¯†è·¯å¾„è¾“å…¥æ¨¡å¼ - å®Œæ•´å®ç°æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æˆ‘ä»¬å·²æˆåŠŸå®ç°æ”¯æŒ**çŸ¥è¯†è·¯å¾„è¾“å…¥**çš„å¤šæ™ºèƒ½ä½“å†…å®¹ç”Ÿæˆæµæ°´çº¿ã€‚è¿™æ˜¯ç¬¦åˆä½ å®é™…ä¸šåŠ¡åœºæ™¯çš„å®Œæ•´è§£å†³æ–¹æ¡ˆã€‚

## ğŸ¯ æ ¸å¿ƒæ”¹è¿›

### 1. åŒæ¨¡å¼è¾“å…¥æ”¯æŒ

```python
# æ¨¡å¼ 1: ç®€å•ä¸»é¢˜ï¼ˆå¿«é€ŸåŸå‹ï¼‰
request = GenerationRequest(
    topic="æœºå™¨å­¦ä¹ åŸºç¡€",
    target_audience="åˆå­¦è€…"
)

# æ¨¡å¼ 2: çŸ¥è¯†è·¯å¾„ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰ â­
request = GenerationRequest(
    knowledge_path=knowledge_path,  # ä½ çš„ç»“æ„åŒ–æ•°æ®
    page_id="nlp-introduction"
)
```

### 2. æ™ºèƒ½æ¨¡å¼æ£€æµ‹

ç³»ç»Ÿè‡ªåŠ¨æ£€æµ‹è¾“å…¥æ¨¡å¼ï¼š

```python
# åœ¨ GenerationRequest ä¸­
def get_mode(self) -> str:
    if self.knowledge_path is not None:
        return "knowledge_path"  # ä½¿ç”¨é€‚é…å™¨
    elif self.topic is not None:
        return "topic"           # ä½¿ç”¨ LLM
```

### 3. å™è¿°åŒ–ä¸Šä¸‹æ–‡ï¼ˆPaper2Slides æ–¹æ³•ï¼‰

**å…³é”®åˆ›æ–°**ï¼šå°†ç»“æ„åŒ–å…ƒæ•°æ®è½¬æ¢ä¸ºè‡ªç„¶è¯­è¨€æè¿°

```python
# ç»“æ„åŒ–æ•°æ®
node = ContentNode(
    title="NLP å®šä¹‰",
    difficulty=1,
    keywords=["NLP", "AI"],
    is_key_point=True,
    ...
)

# è½¬æ¢ä¸ºå™è¿°åŒ–æè¿°
profile = create_narrative_profile(node)
"""
# çŸ¥è¯†ç‚¹: NLP å®šä¹‰

**éš¾åº¦**: åˆçº§ï¼ˆé€‚åˆåˆå­¦è€…ï¼‰

## å­¦ä¹ ç›®æ ‡
1. ç†è§£ NLP çš„å®šä¹‰
2. æŒæ¡ä¸»è¦åº”ç”¨é¢†åŸŸ

## æ ¸å¿ƒæ¦‚å¿µ
**å…³é”®è¯**: NLP, AI

## ç‰¹ç‚¹
- ğŸ”‘ å…³é”®çŸ¥è¯†ç‚¹ - è¿™æ˜¯æ ¸å¿ƒå†…å®¹

## åº”ç”¨åœºæ™¯
- æœºå™¨ç¿»è¯‘
- æ™ºèƒ½å®¢æœ

## å¸¸è§è¯¯åŒº âš ï¸
1. NLP å°±æ˜¯æœºå™¨ç¿»è¯‘
2. NLP åªèƒ½å¤„ç†è‹±æ–‡
"""
```

## ğŸ“ æ–‡ä»¶ç»“æ„

```
backend/
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ schemas.py                  # æ‰©å±•æ”¯æŒ KnowledgePoint/KnowledgePath
â”‚   â”œâ”€â”€ adapters.py                 # çŸ¥è¯†è·¯å¾„ â†’ éª¨æ¶è½¬æ¢å™¨ â­
â”‚   â””â”€â”€ narrative.py                # å™è¿°åŒ–å·¥å…· â­â­
â”‚
â”œâ”€â”€ agents/
â”‚   â”œâ”€â”€ planner.py                  # æ”¯æŒ 2 ç§æ¨¡å¼
â”‚   â”œâ”€â”€ content_expert.py           # åŸç‰ˆï¼ˆç›´æ¥ JSONï¼‰
â”‚   â”œâ”€â”€ content_expert_enhanced.py  # å¢å¼ºç‰ˆï¼ˆå™è¿°åŒ–ï¼‰â­
â”‚   â”œâ”€â”€ visual_director.py
â”‚   â””â”€â”€ assembler.py
â”‚
â”œâ”€â”€ api/
â”‚   â””â”€â”€ main.py                     # æ”¯æŒ 2 ç§è¾“å…¥
â”‚
â”œâ”€â”€ example_usage.py                # åŸå§‹ç¤ºä¾‹
â”œâ”€â”€ example_knowledge_path.py       # çŸ¥è¯†è·¯å¾„ç¤ºä¾‹ â­
â”‚
â””â”€â”€ CONTENT_GENERATION_STRATEGY.md  # æ–¹æ¡ˆå¯¹æ¯”æ–‡æ¡£ â­
```

## ğŸ”„ å®Œæ•´æµç¨‹

### çŸ¥è¯†è·¯å¾„æ¨¡å¼çš„æ‰§è¡Œæµç¨‹

```
ä½ çš„çŸ¥è¯†è·¯å¾„æ•°æ®ï¼ˆJSONï¼‰
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 1: è§£æçŸ¥è¯†è·¯å¾„                              â”‚
â”‚  KnowledgePath.from_json(json_data)             â”‚
â”‚  - 15 ä¸ªçŸ¥è¯†ç‚¹                                     â”‚
â”‚  - åˆ†ä¸º 4 ä¸ªå­åŸŸï¼ˆé¢†åŸŸæ¦‚è¿°ã€åŸºç¡€æ¦‚å¿µã€å†å²...ï¼‰      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 2: è½¬æ¢ä¸ºé¡µé¢éª¨æ¶ï¼ˆæ— éœ€ LLMï¼‰                â”‚
â”‚  knowledge_path_to_skeleton()                   â”‚
â”‚  - æŒ‰å­åŸŸåˆ†ç»„                                      â”‚
â”‚  - æ¨æ–­ç« èŠ‚ç±»å‹ï¼ˆConcept, History, Theory...ï¼‰     â”‚
â”‚  - åˆ›å»º ContentNodeï¼ˆä¿ç•™æ‰€æœ‰å…ƒæ•°æ®ï¼‰              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 3: ç”Ÿæˆå†…å®¹ï¼ˆä½¿ç”¨å™è¿°åŒ–æè¿°ï¼‰                â”‚
â”‚  for each node:                                  â”‚
â”‚    1. create_narrative_profile(node)  â­          â”‚
â”‚    2. LLM åŸºäºæè¿°ç”Ÿæˆå†…å®¹                           â”‚
â”‚    3. è§£æä¸º ContentBlock                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 4: è§†è§‰æ˜ å°„                                  â”‚
â”‚  Visual Director â†’ ç»„ä»¶é€‰æ‹©                        â”‚
â”‚  - è€ƒè™‘å†…å®¹ç±»å‹ã€éš¾åº¦ã€æ—¶é—´                           â”‚
â”‚  - é€‰æ‹©æœ€ä½³ç»„ä»¶ï¼ˆCardGrid, Timeline...ï¼‰            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 5: ç»„è£…ä¸éªŒè¯                                â”‚
â”‚  Assembler â†’ FrontendPageSchema                  â”‚
â”‚  - åˆå¹¶å†…å®¹ + è§†è§‰æ˜ å°„                              â”‚
â”‚  - Pydantic éªŒè¯                                   â”‚
â”‚  - è´¨é‡æ£€æŸ¥                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
      å‰ç«¯å…¼å®¹çš„ JSON Schema
```

## ğŸ’» ä½¿ç”¨ç¤ºä¾‹

### Python SDK

```python
from models.schemas import GenerationRequest, KnowledgePath
from workflows.pipeline import create_pipeline

# 1. ä»ä½ çš„ JSON æ•°æ®åˆ›å»ºçŸ¥è¯†è·¯å¾„
knowledge_path = KnowledgePath(
    knowledge_points=[kp1, kp2, kp3, ...],  # ä½ çš„çŸ¥è¯†ç‚¹
    domain="è‡ªç„¶è¯­è¨€å¤„ç†",
    target_audience="AI åˆå­¦è€…"
)

# 2. åˆ›å»ºç”Ÿæˆè¯·æ±‚
request = GenerationRequest(
    knowledge_path=knowledge_path,  # â­ ä½¿ç”¨çŸ¥è¯†è·¯å¾„æ¨¡å¼
    page_id="nlp-intro",
    custom_title="NLP å®Œæ•´å…¥é—¨"
)

# 3. è¿è¡Œæµæ°´çº¿
pipeline = create_pipeline()
response = pipeline.run(request)

# 4. è®¿é—®ç»“æœ
if response.success:
    schema = response.page_schema
    print(f"ç”Ÿæˆäº† {len(schema.sections)} ä¸ªç« èŠ‚")
    print(f"åŒ…å« {len(schema.components)} ä¸ªç»„ä»¶")
```

### API è°ƒç”¨

```bash
curl -X POST http://localhost:8000/generate \
  -H "Content-Type: application/json" \
  -d '{
    "knowledge_path": {
      "knowledge_points": [...],
      "domain": "è‡ªç„¶è¯­è¨€å¤„ç†"
    },
    "page_id": "nlp-intro",
    "target_audience": "åˆå­¦è€…"
  }'
```

### å‰ç«¯é›†æˆ

```typescript
// 1. è°ƒç”¨åç«¯ API ç”Ÿæˆå†…å®¹
const response = await fetch('/api/generate', {
  method: 'POST',
  body: JSON.stringify({
    knowledge_path: yourKnowledgePath,
    page_id: 'nlp-intro'
  })
});

const schema = await response.json();

// 2. ä¿å­˜åˆ° public/pages/
await saveJsonFile(`public/pages/${schema.page_id}.json`, schema);

// 3. ä½¿ç”¨ SchemaRenderer æ¸²æŸ“
import { SchemaRenderer } from './renderer/SchemaRenderer';

<SchemaRenderer pageId="nlp-intro" />
```

## ğŸ¨ å…³é”®ç‰¹æ€§

### 1. å®Œæ•´ä¿ç•™å…ƒæ•°æ®

ä½ çš„æ‰€æœ‰çŸ¥è¯†ç‚¹å­—æ®µéƒ½è¢«ä¿ç•™å’Œä½¿ç”¨ï¼š

```python
KnowledgePoint {
    "knowledge_id": "D02-M01-K008",
    "name": "è‡ªç„¶è¯­è¨€å¤„ç†æ¦‚è¿°",
    "difficulty": 1,           # âœ… è½¬æ¢ä¸º DifficultyLevel
    "cognitive_level": "COG_L1", # âœ… ä¿ç•™åœ¨ ContentNode
    "importance": 0.8,         # âœ… ç”¨äºè§†è§‰å†³ç­–
    "is_key_point": true,      # âœ… æ ‡è®°å…³é”®å†…å®¹
    "keywords": [...],         # âœ… èå…¥å†…å®¹ç”Ÿæˆ
    "application_scenarios": [...], # âœ… ç”Ÿæˆç¤ºä¾‹
    "common_misconceptions": [...]  # âœ… ç”Ÿæˆè­¦ç¤º
}
```

### 2. æ™ºèƒ½ç« èŠ‚åˆ†ç»„

æŒ‰ `subdomain` è‡ªåŠ¨åˆ†ç»„ï¼š

```python
# è¾“å…¥ï¼š15 ä¸ªçŸ¥è¯†ç‚¹ï¼Œ4 ä¸ªä¸åŒçš„ subdomain
{
    "é¢†åŸŸæ¦‚è¿°": [kp1, kp2],
    "åŸºç¡€æ¦‚å¿µ": [kp3, kp4, kp5],
    "å†å²å‘å±•": [kp6, kp7, kp8],
    "NLPä»»åŠ¡": [kp9, kp10, ...]
}

# è¾“å‡ºï¼š4 ä¸ªç« èŠ‚
{
    sections: [
        { title: "é¢†åŸŸæ¦‚è¿°", type: Concept },
        { title: "åŸºç¡€æ¦‚å¿µ", type: Theory },
        { title: "å†å²å‘å±•", type: History },
        { title: "NLPä»»åŠ¡", type: Application }
    ]
}
```

### 3. æ™ºèƒ½ç»„ä»¶é€‰æ‹©

Visual Director æ ¹æ®å†…å®¹ç‰¹å¾é€‰æ‹©ç»„ä»¶ï¼š

| çŸ¥è¯†ç‚¹ç‰¹å¾ | é€‰æ‹©ç»„ä»¶ |
|-----------|---------|
| å¤šä¸ªç›¸å…³æ¦‚å¿µ | CardGrid |
| å†å²å‘å±•é˜¶æ®µ | Timeline |
| æŠ½è±¡å®šä¹‰ | Flashcard |
| å®è·µç»ƒä¹  | FlashcardGrid / Cloze |
| ä»£ç ç¤ºä¾‹ | CodePlayground |

### 4. ä¸°å¯Œçš„å†…å®¹ç”Ÿæˆ

Content Expert ä½¿ç”¨å™è¿°åŒ–æè¿°ç”Ÿæˆï¼š

- âœ… ä¸»è¦æ–‡ç« ï¼ˆMarkdownï¼‰
- âœ… å…³é”®è¦ç‚¹ï¼ˆ3-7 ä¸ªï¼‰
- âœ… å®ä¾‹è¯´æ˜ï¼ˆ2-4 ä¸ªï¼‰
- âœ… ç±»æ¯”è§£é‡Šï¼ˆ1-2 ä¸ªï¼‰
- âœ… å¸¸è§è¯¯åŒºè­¦ç¤º
- âœ… è‡ªæµ‹é—®é¢˜ï¼ˆ2-3 ä¸ªï¼‰

## ğŸ“Š æ•ˆæœå¯¹æ¯”

| æŒ‡æ ‡ | å•æ¬¡ LLM | å¤šæ™ºèƒ½ä½“ï¼ˆæ—§ï¼‰ | å¤šæ™ºèƒ½ä½“ï¼ˆæ–°ï¼‰â­ |
|-----|----------|--------------|----------------|
| ç»“æ„ä¸€è‡´æ€§ | âŒ ä½ | â­â­â­ ä¸­ | â­â­â­â­â­ é«˜ |
| ç»„ä»¶åˆ©ç”¨ç‡ | â­ ä½ | â­â­â­ ä¸­ | â­â­â­â­â­ é«˜ |
| å…ƒæ•°æ®ä½¿ç”¨ | âŒ æ—  | â­â­ éƒ¨åˆ† | â­â­â­â­â­ å®Œæ•´ |
| å†…å®¹è´¨é‡ | â­â­ ä¸­ | â­â­â­â­ é«˜ | â­â­â­â­â­ ä¼˜ç§€ |
| ç”Ÿæˆé€Ÿåº¦ | â­â­â­â­ å¿« | â­â­â­ ä¸­ | â­â­â­ ä¸­ |
| å¯æ§æ€§ | â­ ä½ | â­â­â­ ä¸­ | â­â­â­â­â­ é«˜ |
| è°ƒè¯•éš¾åº¦ | é«˜ | ä¸­ | ä½ |

## ğŸš€ ä¸‹ä¸€æ­¥

### ç«‹å³å¯ç”¨

```bash
cd backend

# 1. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 2. é…ç½® API Key
export ANTHROPIC_API_KEY="your-key"

# 3. è¿è¡Œç¤ºä¾‹
python example_knowledge_path.py

# 4. å¯åŠ¨ API
python api/main.py
```

### é›†æˆåˆ°ä½ çš„é¡¹ç›®

```javascript
// åœ¨ä½ çš„å‰ç«¯é¡¹ç›®ä¸­

// 1. å¯¼å…¥çŸ¥è¯†è·¯å¾„
const knowledgePath = require('./data/nlp-knowledge-path.json');

// 2. è°ƒç”¨åç«¯ API
async function generatePage(knowledgePath) {
  const response = await fetch('http://localhost:8000/generate', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      knowledge_path: knowledgePath,
      page_id: knowledgePath.domain.toLowerCase().replace(/\s/g, '-')
    })
  });

  return response.json();
}

// 3. ä¿å­˜å¹¶æ˜¾ç¤º
const schema = await generatePage(knowledgePath);
saveAsFile(schema, `public/pages/${schema.page_id}.json`);
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

1. **[schemas.py](models/schemas.py)** - æ•°æ®æ¨¡å‹å®šä¹‰
2. **[adapters.py](models/adapters.py)** - çŸ¥è¯†è·¯å¾„è½¬æ¢å™¨
3. **[narrative.py](models/narrative.py)** - å™è¿°åŒ–å·¥å…·
4. **[content_expert_enhanced.py](agents/content_expert_enhanced.py)** - å¢å¼ºç‰ˆå†…å®¹ä¸“å®¶
5. **[example_knowledge_path.py](example_knowledge_path.py)** - å®Œæ•´ä½¿ç”¨ç¤ºä¾‹
6. **[CONTENT_GENERATION_STRATEGY.md](CONTENT_GENERATION_STRATEGY.md)** - æ–¹æ¡ˆå¯¹æ¯”

## âœ… æ€»ç»“

ä½ ç°åœ¨æ‹¥æœ‰ä¸€ä¸ªå®Œæ•´çš„ã€ç”Ÿäº§å°±ç»ªçš„å¤šæ™ºèƒ½ä½“å†…å®¹ç”Ÿæˆç³»ç»Ÿï¼š

1. âœ… **æ”¯æŒä½ çš„çŸ¥è¯†è·¯å¾„æ ¼å¼**
2. âœ… **ä¿ç•™æ‰€æœ‰å…ƒæ•°æ®**
3. âœ… **æ™ºèƒ½ç« èŠ‚åˆ†ç»„**
4. âœ… **å™è¿°åŒ–ä¸Šä¸‹æ–‡**ï¼ˆPaper2Slides æ–¹æ³•ï¼‰
5. âœ… **é«˜è´¨é‡å†…å®¹ç”Ÿæˆ**
6. âœ… **æ™ºèƒ½ç»„ä»¶é€‰æ‹©**
7. âœ… **å‰ç«¯å…¼å®¹è¾“å‡º**

**å…³é”®ä¼˜åŠ¿**ï¼š
- ğŸ¯ **ç²¾å‡†æ§åˆ¶**ï¼šæ¯ä¸ªå…ƒæ•°æ®éƒ½è¢«æœ‰æ„ä¹‰åœ°ä½¿ç”¨
- ğŸ”„ **å¯è¿½æº¯**ï¼šæ¸…æ¥šçŸ¥é“æ¯éƒ¨åˆ†å†…å®¹åŸºäºä»€ä¹ˆä¿¡æ¯ç”Ÿæˆ
- ğŸ› ï¸ **å¯è°ƒè¯•**ï¼šå¯ä»¥æŸ¥çœ‹å™è¿°åŒ–æè¿°æ¥è¯Šæ–­é—®é¢˜
- ğŸš€ **å¯æ‰©å±•**ï¼šæ˜“äºæ·»åŠ æ–°çš„å…ƒæ•°æ®å­—æ®µæˆ–è°ƒæ•´å™è¿°åŒ–ç­–ç•¥

å¼€å§‹ä½¿ç”¨å§ï¼ğŸ‰
